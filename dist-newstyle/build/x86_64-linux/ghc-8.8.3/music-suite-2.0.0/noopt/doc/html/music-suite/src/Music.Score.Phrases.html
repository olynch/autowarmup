<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FunctionalDependencies #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE NoImplicitPrelude #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wall
  -Wcompat
  -Wincomplete-record-updates
  -Wincomplete-uni-patterns
  -Werror
  -fno-warn-name-shadowing
  -fno-warn-unused-matches
  -fno-warn-unused-imports #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-incomplete-patterns #-}</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-comment">-- | Provides phrase-wise traversal.</span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Music.Score.Phrases</span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * HasPhrases class</span></span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Music.Score.Phrases.html#HasPhrases"><span class="hs-identifier">HasPhrases</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Music.Score.Phrases.html#HasPhrases%27"><span class="hs-identifier">HasPhrases'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Music.Score.Phrases.html#phrases"><span class="hs-identifier">phrases</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Music.Score.Phrases.html#phrases%27"><span class="hs-identifier">phrases'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Phrase types etc</span></span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Music.Score.Phrases.html#Phrase"><span class="hs-identifier">Phrase</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Music.Score.Phrases.html#MVoice"><span class="hs-identifier">MVoice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Music.Score.Phrases.html#PVoice"><span class="hs-identifier">PVoice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Utility</span></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="Music.Score.Phrases.html#mVoicePVoice"><span class="hs-identifier">mVoicePVoice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="Music.Score.Phrases.html#singleMVoice"><span class="hs-identifier">singleMVoice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-comment">-- oldSingleMVoice,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="Music.Score.Phrases.html#mapPhrasesWithPrevAndCurrentOnset"><span class="hs-identifier">mapPhrasesWithPrevAndCurrentOnset</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">where</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">BasePrelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator">(&lt;&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier">Dynamic</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier">first</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier">second</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator">(&amp;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">rewrite</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Plus</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.AffineSpace</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.AffineSpace.Point.Offsets.html"><span class="hs-identifier">Data.AffineSpace.Point.Offsets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.Point.Offsets.html#offsetPoints"><span class="hs-identifier">offsetPoints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier">Data.Bifunctor</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/k3irns0ihl5b8m68yhyd0g48y5yffpcb-colour-2.3.5-doc/share/doc/colour-2.3.5/html/src"><span class="hs-identifier">Data.Colour.Names</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Color</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Functor.Context.html"><span class="hs-identifier">Data.Functor.Context</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Functor.Couple.html"><span class="hs-identifier">Data.Functor.Couple</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier">Data.Semigroup</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.VectorSpace</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Sum</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Music.Score.Part.html"><span class="hs-identifier">Music.Score.Part</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Music.Time.Aligned.html"><span class="hs-identifier">Music.Time.Aligned</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Music.Time.Duration.html"><span class="hs-identifier">Music.Time.Duration</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Music.Time.Event.html"><span class="hs-identifier">Music.Time.Event</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Music.Time.Internal.Convert.html"><span class="hs-identifier">Music.Time.Internal.Convert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Music.Time.Internal.Util.html"><span class="hs-identifier">Music.Time.Internal.Util</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Music.Time.Note.html"><span class="hs-identifier">Music.Time.Note</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Music.Time.Placed.html"><span class="hs-identifier">Music.Time.Placed</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Music.Time.Score.html"><span class="hs-identifier">Music.Time.Score</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Music.Time.Track.html"><span class="hs-identifier">Music.Time.Track</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Music.Time.Voice.html"><span class="hs-identifier">Music.Time.Voice</span></a></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- For a phrase, we simply use a voice without rests.</span><span>
</span><span id="line-64"></span><span class="hs-comment">--</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- To represent a sequence of phrases we provide two equivalent representations:</span><span>
</span><span id="line-66"></span><span class="hs-comment">--</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- * 'MVoice' is a sequence of notes/chords or rests. All consecutive non-rests consitute a phrase.</span><span>
</span><span id="line-68"></span><span class="hs-comment">--</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- * 'PVoice' is a sequence of phrases or durations.</span><span>
</span><span id="line-70"></span><span class="hs-keyword">type</span><span> </span><span id="Phrase"><span class="annot"><a href="Music.Score.Phrases.html#Phrase"><span class="hs-identifier hs-var">Phrase</span></a></span></span><span> </span><span id="local-6989586621680580772"><span class="annot"><a href="#local-6989586621680580772"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Music.Time.Voice.html#Voice"><span class="hs-identifier hs-type">Voice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580772"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- A sequence of phrases or rests, represented as notes or rests.</span><span>
</span><span id="line-74"></span><span class="hs-comment">--</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- Each consecutive sequence of non-rest elements is considered to be a phrase.</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- For a more explicit representation of the phrase structure, see 'PVoice'.</span><span>
</span><span id="line-77"></span><span class="hs-keyword">type</span><span> </span><span id="MVoice"><span class="annot"><a href="Music.Score.Phrases.html#MVoice"><span class="hs-identifier hs-var">MVoice</span></a></span></span><span> </span><span id="local-6989586621680580771"><span class="annot"><a href="#local-6989586621680580771"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Music.Time.Voice.html#Voice"><span class="hs-identifier hs-type">Voice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580771"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- A sequence of phrases or rests, represented with explicit phrase structure.</span><span>
</span><span id="line-81"></span><span class="hs-keyword">type</span><span> </span><span id="PVoice"><span class="annot"><a href="Music.Score.Phrases.html#PVoice"><span class="hs-identifier hs-var">PVoice</span></a></span></span><span> </span><span id="local-6989586621680580770"><span class="annot"><a href="#local-6989586621680580770"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Music.Time.Types.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#Phrase"><span class="hs-identifier hs-type">Phrase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580770"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- A sequence of phrases or rests, represented as phrases with an explicit onset.</span><span>
</span><span id="line-85"></span><span class="hs-comment">--</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- This is only isomorphic to 'MVoice' (and 'PVoice') up to onset equivalence.</span><span>
</span><span id="line-87"></span><span class="hs-keyword">type</span><span> </span><span id="TVoice"><span class="annot"><a href="Music.Score.Phrases.html#TVoice"><span class="hs-identifier hs-var">TVoice</span></a></span></span><span> </span><span id="local-6989586621680580769"><span class="annot"><a href="#local-6989586621680580769"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Music.Time.Track.html#Track"><span class="hs-identifier hs-type">Track</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#Phrase"><span class="hs-identifier hs-type">Phrase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580769"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- Class of structures that can be traversed &quot;by phrase&quot;.</span><span>
</span><span id="line-91"></span><span class="hs-comment">--</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- A /phrase/ in this context is a sequence of consecutive notes played by the</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- same performer, with no rests in between. Phrase traverals are used for</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- attaching articulation marks, slurs and so on, but can also be used separately.</span><span>
</span><span id="line-95"></span><span class="hs-keyword">class</span><span> </span><span id="HasPhrases"><span class="annot"><a href="Music.Score.Phrases.html#HasPhrases"><span class="hs-identifier hs-var">HasPhrases</span></a></span></span><span> </span><span id="local-6989586621680581090"><span class="annot"><a href="#local-6989586621680581090"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680581089"><span class="annot"><a href="#local-6989586621680581089"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680581088"><span class="annot"><a href="#local-6989586621680581088"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621680581087"><span class="annot"><a href="#local-6989586621680581087"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621680581090"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680581088"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680581089"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680581087"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680581090"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581087"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680581089"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680581089"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581088"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680581090"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-96"></span><span>  </span><span id="mvoices"><span class="annot"><a href="Music.Score.Phrases.html#mvoices"><span class="hs-identifier hs-type">mvoices</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversal</span></span><span> </span><span class="annot"><a href="#local-6989586621680581090"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581089"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#MVoice"><span class="hs-identifier hs-type">MVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581088"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#MVoice"><span class="hs-identifier hs-type">MVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581087"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- | Traverses all phrases in a voice.</span><span>
</span><span id="line-99"></span><span id="local-6989586621680580766"><span id="local-6989586621680580767"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#HasPhrases"><span class="hs-identifier hs-type">HasPhrases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#MVoice"><span class="hs-identifier hs-type">MVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580767"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#MVoice"><span class="hs-identifier hs-type">MVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580766"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680580767"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580766"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-100"></span><span>  </span><span id="local-6989586621680580763"><span class="annot"><span class="annottext">mvoices :: (MVoice a -&gt; f (MVoice b)) -&gt; MVoice a -&gt; f (MVoice b)
</span><a href="#local-6989586621680580763"><span class="hs-identifier hs-var hs-var hs-var hs-var">mvoices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MVoice a -&gt; f (MVoice b)) -&gt; MVoice a -&gt; f (MVoice b)
forall k (cat :: k -&gt; k -&gt; *) (a :: k). Category cat =&gt; cat a a
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">id</span></a></span></span></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span id="local-6989586621680580760"><span id="local-6989586621680580761"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#HasPhrases"><span class="hs-identifier hs-type">HasPhrases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#PVoice"><span class="hs-identifier hs-type">PVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580761"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#PVoice"><span class="hs-identifier hs-type">PVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580760"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680580761"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580760"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-comment">-- Note: This is actually OK in 'phr', as that just becomes (id . each . _Right)</span><span>
</span><span id="line-104"></span><span>  </span><span id="local-6989586621680580758"><span class="annot"><span class="annottext">mvoices :: (MVoice a -&gt; f (MVoice b)) -&gt; PVoice a -&gt; f (PVoice b)
</span><a href="#local-6989586621680580758"><span class="hs-identifier hs-var hs-var hs-var hs-var">mvoices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AnIso (MVoice b) (MVoice a) (PVoice b) (PVoice a)
-&gt; Iso (PVoice a) (PVoice b) (MVoice a) (MVoice b)
forall s t a b. AnIso s t a b -&gt; Iso b a t s
</span><span class="hs-identifier hs-var">from</span></span><span> </span><span class="annot"><span class="annottext">AnIso (MVoice b) (MVoice a) (PVoice b) (PVoice a)
forall a b. Iso (MVoice a) (MVoice b) (PVoice a) (PVoice b)
</span><a href="Music.Score.Phrases.html#mVoicePVoiceIgnoringMeta"><span class="hs-identifier hs-var">mVoicePVoiceIgnoringMeta</span></a></span></span></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-comment">-- | Traverses all phrases in each voice, using 'extracted'.</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- TODO get rid of UndecidableInstances</span><span>
</span><span id="line-108"></span><span id="local-6989586621680580754"><span id="local-6989586621680580755"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Part.html#HasParts%27"><span class="hs-identifier hs-type">HasParts'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580755"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Part.html#Part"><span class="hs-identifier hs-type">Part</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580755"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680580755"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580754"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#HasPhrases"><span class="hs-identifier hs-type">HasPhrases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Time.Score.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580755"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Time.Score.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580754"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680580755"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580754"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-109"></span><span>  </span><span id="local-6989586621680580752"><span class="annot"><span class="annottext">mvoices :: (MVoice a -&gt; f (MVoice b)) -&gt; Score a -&gt; f (Score b)
</span><a href="#local-6989586621680580752"><span class="hs-identifier hs-var hs-var hs-var hs-var">mvoices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Score b] -&gt; f [Score b]) -&gt; Score b -&gt; f (Score b)
forall a b.
(Ord (Part a), HasParts' a) =&gt;
Iso (Score a) (Score b) [Score a] [Score b]
</span><a href="Music.Score.Part.html#extracted"><span class="hs-identifier hs-var">extracted</span></a></span><span> </span><span class="annot"><span class="annottext">(([Score b] -&gt; f [Score b]) -&gt; Score b -&gt; f (Score b))
-&gt; ((MVoice b -&gt; f (MVoice b)) -&gt; [Score b] -&gt; f [Score b])
-&gt; (MVoice b -&gt; f (MVoice b))
-&gt; Score b
-&gt; f (Score b)
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Score b -&gt; f (Score b)) -&gt; [Score b] -&gt; f [Score b]
forall s t a b. Each s t a b =&gt; Traversal s t a b
</span><span class="hs-identifier hs-var">each</span></span><span> </span><span class="annot"><span class="annottext">((Score b -&gt; f (Score b)) -&gt; [Score b] -&gt; f [Score b])
-&gt; ((MVoice b -&gt; f (MVoice b)) -&gt; Score b -&gt; f (Score b))
-&gt; (MVoice b -&gt; f (MVoice b))
-&gt; [Score b]
-&gt; f [Score b]
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(MVoice b -&gt; f (MVoice b)) -&gt; Score b -&gt; f (Score b)
forall a b.
(a ~ b) =&gt;
Prism (Score a) (Score b) (MVoice a) (MVoice b)
</span><a href="Music.Score.Phrases.html#singleMVoice"><span class="hs-identifier hs-var">singleMVoice</span></a></span></span></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-comment">{-
instance HasPhrases (Note a) (Note b) a b where
  mvoices f (Note (d, x)) = f (Voice [
-}</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">{-
TODO get rid of the (a ~ b) restriction

To understand why it is there in the first place:

- Consider a score where some part has overlapping events

- The overlap means that singleMVoice will fail to match that particular part
  (this is why singleMVoice is a Prism and not an Iso/Lens).

- Consequently, the phrase traversal may not be able to modify certain parts, and must
  therefore retain them in their original form.

To get around this, we would need a version of singleMVoice that included voice separation.
That way, we would have the option to break up arbitrary scores into parts for them
purpose of the phrase traversal.
-}</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-keyword">type</span><span> </span><span id="HasPhrases%27"><span class="annot"><a href="Music.Score.Phrases.html#HasPhrases%27"><span class="hs-identifier hs-var">HasPhrases'</span></a></span></span><span> </span><span id="local-6989586621680580748"><span class="annot"><a href="#local-6989586621680580748"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680580747"><span class="annot"><a href="#local-6989586621680580747"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#HasPhrases"><span class="hs-identifier hs-type">HasPhrases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580748"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580748"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580747"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580747"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- A simple generic phrase-traversal.</span><span>
</span><span id="line-138"></span><span id="local-6989586621680580745"><span id="local-6989586621680580746"><span class="annot"><a href="Music.Score.Phrases.html#phrases%27"><span class="hs-identifier hs-type">phrases'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#HasPhrases%27"><span class="hs-identifier hs-type">HasPhrases'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580746"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580745"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversal'</span></span><span> </span><span class="annot"><a href="#local-6989586621680580746"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#Phrase"><span class="hs-identifier hs-type">Phrase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580745"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-139"></span><span id="phrases%27"><span class="annot"><span class="annottext">phrases' :: Traversal' s (Phrase a)
</span><a href="Music.Score.Phrases.html#phrases%27"><span class="hs-identifier hs-var hs-var">phrases'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Phrase a -&gt; f (Phrase a)) -&gt; s -&gt; f s
forall s t a b.
HasPhrases s t a b =&gt;
Traversal s t (Phrase a) (Phrase b)
</span><a href="Music.Score.Phrases.html#phrases"><span class="hs-identifier hs-var">phrases</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- A generic phrase-traversal.</span><span>
</span><span id="line-143"></span><span id="local-6989586621680581042"><span id="local-6989586621680581043"><span id="local-6989586621680581044"><span id="local-6989586621680581045"><span class="annot"><a href="Music.Score.Phrases.html#phrases"><span class="hs-identifier hs-type">phrases</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#HasPhrases"><span class="hs-identifier hs-type">HasPhrases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581045"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581044"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581043"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581042"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversal</span></span><span> </span><span class="annot"><a href="#local-6989586621680581045"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581044"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#Phrase"><span class="hs-identifier hs-type">Phrase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581043"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#Phrase"><span class="hs-identifier hs-type">Phrase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581042"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-144"></span><span id="phrases"><span class="annot"><span class="annottext">phrases :: Traversal s t (Phrase a) (Phrase b)
</span><a href="Music.Score.Phrases.html#phrases"><span class="hs-identifier hs-var hs-var">phrases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MVoice a -&gt; f (MVoice b)) -&gt; s -&gt; f t
forall s t a b.
HasPhrases s t a b =&gt;
Traversal s t (MVoice a) (MVoice b)
</span><a href="Music.Score.Phrases.html#mvoices"><span class="hs-identifier hs-var">mvoices</span></a></span><span> </span><span class="annot"><span class="annottext">((MVoice a -&gt; f (MVoice b)) -&gt; s -&gt; f t)
-&gt; ((Phrase a -&gt; f (Phrase b)) -&gt; MVoice a -&gt; f (MVoice b))
-&gt; (Phrase a -&gt; f (Phrase b))
-&gt; s
-&gt; f t
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(PVoice a -&gt; f (PVoice b)) -&gt; MVoice a -&gt; f (MVoice b)
forall a b. Lens (MVoice a) (MVoice b) (PVoice a) (PVoice b)
</span><a href="Music.Score.Phrases.html#mVoicePVoice"><span class="hs-identifier hs-var">mVoicePVoice</span></a></span><span> </span><span class="annot"><span class="annottext">((PVoice a -&gt; f (PVoice b)) -&gt; MVoice a -&gt; f (MVoice b))
-&gt; ((Phrase a -&gt; f (Phrase b)) -&gt; PVoice a -&gt; f (PVoice b))
-&gt; (Phrase a -&gt; f (Phrase b))
-&gt; MVoice a
-&gt; f (MVoice b)
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Either Duration (Phrase a) -&gt; f (Either Duration (Phrase b)))
-&gt; PVoice a -&gt; f (PVoice b)
forall s t a b. Each s t a b =&gt; Traversal s t a b
</span><span class="hs-identifier hs-var">each</span></span><span> </span><span class="annot"><span class="annottext">((Either Duration (Phrase a) -&gt; f (Either Duration (Phrase b)))
 -&gt; PVoice a -&gt; f (PVoice b))
-&gt; ((Phrase a -&gt; f (Phrase b))
    -&gt; Either Duration (Phrase a) -&gt; f (Either Duration (Phrase b)))
-&gt; (Phrase a -&gt; f (Phrase b))
-&gt; PVoice a
-&gt; f (PVoice b)
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Phrase a -&gt; f (Phrase b))
-&gt; Either Duration (Phrase a) -&gt; f (Either Duration (Phrase b))
forall c a b. Prism (Either c a) (Either c b) a b
</span><span class="hs-identifier hs-var">_Right</span></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- View an 'MVoice' as a 'PVoice'.</span><span>
</span><span id="line-148"></span><span id="local-6989586621680581035"><span id="local-6989586621680581036"><span class="annot"><a href="Music.Score.Phrases.html#mVoicePVoice"><span class="hs-identifier hs-type">mVoicePVoice</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#MVoice"><span class="hs-identifier hs-type">MVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581036"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#MVoice"><span class="hs-identifier hs-type">MVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581035"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#PVoice"><span class="hs-identifier hs-type">PVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581036"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#PVoice"><span class="hs-identifier hs-type">PVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581035"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-149"></span><span id="mVoicePVoice"><span class="annot"><span class="annottext">mVoicePVoice :: (PVoice a -&gt; f (PVoice b)) -&gt; MVoice a -&gt; f (MVoice b)
</span><a href="Music.Score.Phrases.html#mVoicePVoice"><span class="hs-identifier hs-var hs-var">mVoicePVoice</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PVoice a -&gt; f (PVoice b)) -&gt; MVoice a -&gt; f (MVoice b)
forall a b. Iso (MVoice a) (MVoice b) (PVoice a) (PVoice b)
</span><a href="Music.Score.Phrases.html#mVoicePVoiceIgnoringMeta"><span class="hs-identifier hs-var">mVoicePVoiceIgnoringMeta</span></a></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">-- TODO meta</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- View an 'MVoice' as a 'PVoice' and vice versa.</span><span>
</span><span id="line-155"></span><span class="hs-comment">--</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- This a valid 'Iso' up to meta-data equivalence.</span><span>
</span><span id="line-157"></span><span id="local-6989586621680581070"><span id="local-6989586621680581071"><span class="annot"><a href="Music.Score.Phrases.html#mVoicePVoiceIgnoringMeta"><span class="hs-identifier hs-type">mVoicePVoiceIgnoringMeta</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Iso</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#MVoice"><span class="hs-identifier hs-type">MVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581071"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#MVoice"><span class="hs-identifier hs-type">MVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581070"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#PVoice"><span class="hs-identifier hs-type">PVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581071"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#PVoice"><span class="hs-identifier hs-type">PVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581070"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-158"></span><span id="mVoicePVoiceIgnoringMeta"><span class="annot"><span class="annottext">mVoicePVoiceIgnoringMeta :: p (PVoice a) (f (PVoice b)) -&gt; p (MVoice a) (f (MVoice b))
</span><a href="Music.Score.Phrases.html#mVoicePVoiceIgnoringMeta"><span class="hs-identifier hs-var hs-var">mVoicePVoiceIgnoringMeta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MVoice a -&gt; PVoice a)
-&gt; (PVoice b -&gt; MVoice b)
-&gt; Iso (MVoice a) (MVoice b) (PVoice a) (PVoice b)
forall s a b t. (s -&gt; a) -&gt; (b -&gt; t) -&gt; Iso s t a b
</span><span class="hs-identifier hs-var">iso</span></span><span> </span><span class="annot"><span class="annottext">MVoice a -&gt; PVoice a
forall a. MVoice a -&gt; PVoice a
</span><a href="#local-6989586621680580742"><span class="hs-identifier hs-var">mvoiceToPVoice</span></a></span><span> </span><span class="annot"><span class="annottext">PVoice b -&gt; MVoice b
forall a. PVoice a -&gt; MVoice a
</span><a href="#local-6989586621680580741"><span class="hs-identifier hs-var">pVoiceToMVoice</span></a></span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-160"></span><span>    </span><span id="local-6989586621680581018"><span class="annot"><a href="#local-6989586621680580742"><span class="hs-identifier hs-type">mvoiceToPVoice</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#MVoice"><span class="hs-identifier hs-type">MVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581018"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#PVoice"><span class="hs-identifier hs-type">PVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581018"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-161"></span><span>    </span><span id="local-6989586621680580742"><span class="annot"><span class="annottext">mvoiceToPVoice :: MVoice a -&gt; PVoice a
</span><a href="#local-6989586621680580742"><span class="hs-identifier hs-var hs-var">mvoiceToPVoice</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-162"></span><span>      </span><span class="annot"><span class="annottext">(Either [(Duration, Maybe a)] [(Duration, Maybe a)]
 -&gt; Either Duration (Phrase a))
-&gt; [Either [(Duration, Maybe a)] [(Duration, Maybe a)]] -&gt; PVoice a
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">map</span></a></span><span>
</span><span id="line-163"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">(MVoice a -&gt; Duration)
-&gt; (MVoice a -&gt; Phrase a)
-&gt; Either (MVoice a) (MVoice a)
-&gt; Either Duration (Phrase a)
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">bimap</span></a></span><span> </span><span class="annot"><span class="annottext">MVoice a -&gt; Duration
forall a. MVoice a -&gt; Duration
</span><a href="#local-6989586621680580739"><span class="hs-identifier hs-var">voiceToRest</span></a></span><span> </span><span class="annot"><span class="annottext">MVoice a -&gt; Phrase a
forall a. MVoice a -&gt; Phrase a
</span><a href="#local-6989586621680580738"><span class="hs-identifier hs-var">voiceToPhrase</span></a></span><span>
</span><span id="line-164"></span><span>            </span><span class="annot"><span class="annottext">(Either (MVoice a) (MVoice a) -&gt; Either Duration (Phrase a))
-&gt; (Either [(Duration, Maybe a)] [(Duration, Maybe a)]
    -&gt; Either (MVoice a) (MVoice a))
-&gt; Either [(Duration, Maybe a)] [(Duration, Maybe a)]
-&gt; Either Duration (Phrase a)
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([(Duration, Maybe a)] -&gt; MVoice a)
-&gt; ([(Duration, Maybe a)] -&gt; MVoice a)
-&gt; Either [(Duration, Maybe a)] [(Duration, Maybe a)]
-&gt; Either (MVoice a) (MVoice a)
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">bimap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Duration, Maybe a)]
-&gt; Getting (MVoice a) [(Duration, Maybe a)] (MVoice a) -&gt; MVoice a
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">AnIso
  (MVoice a) (MVoice a) [(Duration, Maybe a)] [(Duration, Maybe a)]
-&gt; Iso
     [(Duration, Maybe a)] [(Duration, Maybe a)] (MVoice a) (MVoice a)
forall s t a b. AnIso s t a b -&gt; Iso b a t s
</span><span class="hs-identifier hs-var">from</span></span><span> </span><span class="annot"><span class="annottext">AnIso
  (MVoice a) (MVoice a) [(Duration, Maybe a)] [(Duration, Maybe a)]
forall a b. Iso (Voice a) (Voice b) [(Duration, a)] [(Duration, b)]
</span><a href="Music.Time.Voice.html#pairs"><span class="hs-identifier hs-var">pairs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Duration, Maybe a)]
-&gt; Getting (MVoice a) [(Duration, Maybe a)] (MVoice a) -&gt; MVoice a
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">AnIso
  (MVoice a) (MVoice a) [(Duration, Maybe a)] [(Duration, Maybe a)]
-&gt; Iso
     [(Duration, Maybe a)] [(Duration, Maybe a)] (MVoice a) (MVoice a)
forall s t a b. AnIso s t a b -&gt; Iso b a t s
</span><span class="hs-identifier hs-var">from</span></span><span> </span><span class="annot"><span class="annottext">AnIso
  (MVoice a) (MVoice a) [(Duration, Maybe a)] [(Duration, Maybe a)]
forall a b. Iso (Voice a) (Voice b) [(Duration, a)] [(Duration, b)]
</span><a href="Music.Time.Voice.html#pairs"><span class="hs-identifier hs-var">pairs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>        </span><span class="annot"><span class="annottext">([Either [(Duration, Maybe a)] [(Duration, Maybe a)]] -&gt; PVoice a)
-&gt; (MVoice a
    -&gt; [Either [(Duration, Maybe a)] [(Duration, Maybe a)]])
-&gt; MVoice a
-&gt; PVoice a
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((Duration, Maybe a) -&gt; Bool)
-&gt; [(Duration, Maybe a)]
-&gt; [Either [(Duration, Maybe a)] [(Duration, Maybe a)]]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [Either [a] [a]]
</span><a href="Music.Score.Phrases.html#groupDiff"><span class="hs-identifier hs-var">groupDiff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">isJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; Bool)
-&gt; ((Duration, Maybe a) -&gt; Maybe a) -&gt; (Duration, Maybe a) -&gt; Bool
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Duration, Maybe a) -&gt; Maybe a
forall a b. (a, b) -&gt; b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>        </span><span class="annot"><span class="annottext">([(Duration, Maybe a)]
 -&gt; [Either [(Duration, Maybe a)] [(Duration, Maybe a)]])
-&gt; (MVoice a -&gt; [(Duration, Maybe a)])
-&gt; MVoice a
-&gt; [Either [(Duration, Maybe a)] [(Duration, Maybe a)]]
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting [(Duration, Maybe a)] (MVoice a) [(Duration, Maybe a)]
-&gt; MVoice a -&gt; [(Duration, Maybe a)]
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting [(Duration, Maybe a)] (MVoice a) [(Duration, Maybe a)]
forall a b. Iso (Voice a) (Voice b) [(Duration, a)] [(Duration, b)]
</span><a href="Music.Time.Voice.html#pairs"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-168"></span><span>    </span><span id="local-6989586621680581007"><span class="annot"><a href="#local-6989586621680580739"><span class="hs-identifier hs-type">voiceToRest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#MVoice"><span class="hs-identifier hs-type">MVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581007"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Music.Time.Types.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span></span><span>
</span><span id="line-169"></span><span>    </span><span id="local-6989586621680580739"><span class="annot"><span class="annottext">voiceToRest :: MVoice a -&gt; Duration
</span><a href="#local-6989586621680580739"><span class="hs-identifier hs-var hs-var">voiceToRest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting (Endo (Endo Duration)) (MVoice a) Duration
-&gt; MVoice a -&gt; Duration
forall a s. Num a =&gt; Getting (Endo (Endo a)) s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">sumOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([(Duration, Maybe a)]
 -&gt; Const (Endo (Endo Duration)) [(Duration, Maybe a)])
-&gt; MVoice a -&gt; Const (Endo (Endo Duration)) (MVoice a)
forall a b. Iso (Voice a) (Voice b) [(Duration, a)] [(Duration, b)]
</span><a href="Music.Time.Voice.html#pairs"><span class="hs-identifier hs-var">pairs</span></a></span><span> </span><span class="annot"><span class="annottext">(([(Duration, Maybe a)]
  -&gt; Const (Endo (Endo Duration)) [(Duration, Maybe a)])
 -&gt; MVoice a -&gt; Const (Endo (Endo Duration)) (MVoice a))
-&gt; ((Duration -&gt; Const (Endo (Endo Duration)) Duration)
    -&gt; [(Duration, Maybe a)]
    -&gt; Const (Endo (Endo Duration)) [(Duration, Maybe a)])
-&gt; Getting (Endo (Endo Duration)) (MVoice a) Duration
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((Duration, Maybe a)
 -&gt; Const (Endo (Endo Duration)) (Duration, Maybe a))
-&gt; [(Duration, Maybe a)]
-&gt; Const (Endo (Endo Duration)) [(Duration, Maybe a)]
forall s t a b. Each s t a b =&gt; Traversal s t a b
</span><span class="hs-identifier hs-var">each</span></span><span> </span><span class="annot"><span class="annottext">(((Duration, Maybe a)
  -&gt; Const (Endo (Endo Duration)) (Duration, Maybe a))
 -&gt; [(Duration, Maybe a)]
 -&gt; Const (Endo (Endo Duration)) [(Duration, Maybe a)])
-&gt; ((Duration -&gt; Const (Endo (Endo Duration)) Duration)
    -&gt; (Duration, Maybe a)
    -&gt; Const (Endo (Endo Duration)) (Duration, Maybe a))
-&gt; (Duration -&gt; Const (Endo (Endo Duration)) Duration)
-&gt; [(Duration, Maybe a)]
-&gt; Const (Endo (Endo Duration)) [(Duration, Maybe a)]
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Duration -&gt; Const (Endo (Endo Duration)) Duration)
-&gt; (Duration, Maybe a)
-&gt; Const (Endo (Endo Duration)) (Duration, Maybe a)
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(MVoice a -&gt; Duration)
-&gt; (MVoice a -&gt; MVoice a) -&gt; MVoice a -&gt; Duration
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; Maybe a) -&gt; MVoice a -&gt; MVoice a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680580730"><span class="annot"><span class="annottext">x :: Maybe a
</span><a href="#local-6989586621680580730"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe a -&gt; Maybe a
forall a. (?callStack::CallStack) =&gt; Bool -&gt; a -&gt; a
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">isNothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621680580730"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621680580730"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-comment">-- TODO just _duration</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span>    </span><span id="local-6989586621680581006"><span class="annot"><a href="#local-6989586621680580738"><span class="hs-identifier hs-type">voiceToPhrase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#MVoice"><span class="hs-identifier hs-type">MVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581006"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#Phrase"><span class="hs-identifier hs-type">Phrase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581006"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-173"></span><span>    </span><span id="local-6989586621680580738"><span class="annot"><span class="annottext">voiceToPhrase :: MVoice a -&gt; Phrase a
</span><a href="#local-6989586621680580738"><span class="hs-identifier hs-var hs-var">voiceToPhrase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; a) -&gt; MVoice a -&gt; Phrase a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; a
forall a. (?callStack::CallStack) =&gt; Maybe a -&gt; a
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">fromJust</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span id="local-6989586621680581017"><span class="annot"><a href="#local-6989586621680580741"><span class="hs-identifier hs-type">pVoiceToMVoice</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#PVoice"><span class="hs-identifier hs-type">PVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581017"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#MVoice"><span class="hs-identifier hs-type">MVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581017"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-175"></span><span>    </span><span id="local-6989586621680580741"><span class="annot"><span class="annottext">pVoiceToMVoice :: PVoice a -&gt; MVoice a
</span><a href="#local-6989586621680580741"><span class="hs-identifier hs-var hs-var">pVoiceToMVoice</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MVoice a] -&gt; MVoice a
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span> </span><span class="annot"><span class="annottext">([MVoice a] -&gt; MVoice a)
-&gt; (PVoice a -&gt; [MVoice a]) -&gt; PVoice a -&gt; MVoice a
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Either Duration (Phrase a) -&gt; MVoice a) -&gt; PVoice a -&gt; [MVoice a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Duration -&gt; MVoice a)
-&gt; (Phrase a -&gt; MVoice a) -&gt; Either Duration (Phrase a) -&gt; MVoice a
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="annot"><span class="annottext">Duration -&gt; MVoice a
forall a. Duration -&gt; MVoice a
</span><a href="#local-6989586621680580726"><span class="hs-identifier hs-var">restToVoice</span></a></span><span> </span><span class="annot"><span class="annottext">Phrase a -&gt; MVoice a
forall a. Phrase a -&gt; MVoice a
</span><a href="#local-6989586621680580725"><span class="hs-identifier hs-var">phraseToVoice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>    </span><span id="local-6989586621680580970"><span class="annot"><a href="#local-6989586621680580726"><span class="hs-identifier hs-type">restToVoice</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Music.Time.Types.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#MVoice"><span class="hs-identifier hs-type">MVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580970"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-177"></span><span>    </span><span id="local-6989586621680580726"><span class="annot"><span class="annottext">restToVoice :: Duration -&gt; MVoice a
</span><a href="#local-6989586621680580726"><span class="hs-identifier hs-var hs-var">restToVoice</span></a></span></span><span> </span><span id="local-6989586621680580724"><span class="annot"><span class="annottext">d :: Duration
</span><a href="#local-6989586621680580724"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Duration -&gt; MVoice a -&gt; MVoice a
forall a. Transformable a =&gt; Duration -&gt; a -&gt; a
</span><a href="Music.Time.Internal.Transform.html#stretch"><span class="hs-identifier hs-var">stretch</span></a></span><span> </span><span class="annot"><span class="annottext">Duration
</span><a href="#local-6989586621680580724"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(MVoice a -&gt; MVoice a) -&gt; MVoice a -&gt; MVoice a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; MVoice a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-178"></span><span>    </span><span id="local-6989586621680580969"><span class="annot"><a href="#local-6989586621680580725"><span class="hs-identifier hs-type">phraseToVoice</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#Phrase"><span class="hs-identifier hs-type">Phrase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580969"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#MVoice"><span class="hs-identifier hs-type">MVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580969"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621680580725"><span class="annot"><span class="annottext">phraseToVoice :: Phrase a -&gt; MVoice a
</span><a href="#local-6989586621680580725"><span class="hs-identifier hs-var hs-var">phraseToVoice</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; Phrase a -&gt; MVoice a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span id="local-6989586621680581052"><span id="local-6989586621680581053"><span class="annot"><a href="Music.Score.Phrases.html#singleMVoice"><span class="hs-identifier hs-type">singleMVoice</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680581053"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581052"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prism</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Time.Score.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581053"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Time.Score.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581052"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#MVoice"><span class="hs-identifier hs-type">MVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581053"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#MVoice"><span class="hs-identifier hs-type">MVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680581052"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-182"></span><span id="singleMVoice"><span class="annot"><span class="annottext">singleMVoice :: Prism (Score a) (Score b) (MVoice a) (MVoice b)
</span><a href="Music.Score.Phrases.html#singleMVoice"><span class="hs-identifier hs-var hs-var">singleMVoice</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MVoice a -&gt; Score a)
-&gt; (Score a -&gt; Maybe (MVoice a))
-&gt; Prism (Score a) (Score a) (MVoice a) (MVoice a)
forall b s a. (b -&gt; s) -&gt; (s -&gt; Maybe a) -&gt; Prism s s a b
</span><span class="hs-identifier hs-var">prism'</span></span><span> </span><span class="annot"><span class="annottext">MVoice a -&gt; Score a
forall b. MVoice b -&gt; Score b
</span><a href="#local-6989586621680580721"><span class="hs-identifier hs-var">voiceToScore'</span></a></span><span> </span><span class="annot"><span class="annottext">Score a -&gt; Maybe (MVoice a)
forall a. Score a -&gt; Maybe (MVoice a)
</span><a href="#local-6989586621680580720"><span class="hs-identifier hs-var">scoreToVoice</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621680580940"><span class="annot"><a href="#local-6989586621680580719"><span class="hs-identifier hs-type">voiceToScore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Music.Time.Voice.html#Voice"><span class="hs-identifier hs-type">Voice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580940"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Music.Time.Score.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580940"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-185"></span><span>    </span><span id="local-6989586621680580719"><span class="annot"><span class="annottext">voiceToScore :: Voice a -&gt; Score a
</span><a href="#local-6989586621680580719"><span class="hs-identifier hs-var hs-var">voiceToScore</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Aligned (Voice a) -&gt; Score a
forall a. Aligned (Voice a) -&gt; Score a
</span><a href="Music.Time.Aligned.html#renderAlignedVoice"><span class="hs-identifier hs-var">renderAlignedVoice</span></a></span><span> </span><span class="annot"><span class="annottext">(Aligned (Voice a) -&gt; Score a)
-&gt; (Voice a -&gt; Aligned (Voice a)) -&gt; Voice a -&gt; Score a
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Time -&gt; Duration -&gt; Voice a -&gt; Aligned (Voice a)
forall v. Time -&gt; Duration -&gt; v -&gt; Aligned v
</span><a href="Music.Time.Aligned.html#aligned"><span class="hs-identifier hs-var">aligned</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-186"></span><span>    </span><span id="local-6989586621680580951"><span class="annot"><a href="#local-6989586621680580721"><span class="hs-identifier hs-type">voiceToScore'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#MVoice"><span class="hs-identifier hs-type">MVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580951"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Music.Time.Score.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580951"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-187"></span><span>    </span><span id="local-6989586621680580721"><span class="annot"><span class="annottext">voiceToScore' :: MVoice b -&gt; Score b
</span><a href="#local-6989586621680580721"><span class="hs-identifier hs-var hs-var">voiceToScore'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Score (Maybe b) -&gt; Score b
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m (Maybe a) -&gt; m a
</span><span class="hs-identifier hs-var">mcatMaybes</span></span><span> </span><span class="annot"><span class="annottext">(Score (Maybe b) -&gt; Score b)
-&gt; (MVoice b -&gt; Score (Maybe b)) -&gt; MVoice b -&gt; Score b
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">MVoice b -&gt; Score (Maybe b)
forall a. Voice a -&gt; Score a
</span><a href="#local-6989586621680580719"><span class="hs-identifier hs-var">voiceToScore</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621680580950"><span class="annot"><a href="#local-6989586621680580720"><span class="hs-identifier hs-type">scoreToVoice</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Music.Time.Score.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580950"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#MVoice"><span class="hs-identifier hs-type">MVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580950"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-189"></span><span>    </span><span id="local-6989586621680580720"><span class="annot"><span class="annottext">scoreToVoice :: Score a -&gt; Maybe (MVoice a)
</span><a href="#local-6989586621680580720"><span class="hs-identifier hs-var hs-var">scoreToVoice</span></a></span></span><span> </span><span id="local-6989586621680580715"><span class="annot"><span class="annottext">sc :: Score a
</span><a href="#local-6989586621680580715"><span class="hs-identifier hs-var">sc</span></a></span></span><span>
</span><span id="line-190"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Score a -&gt; Bool
forall a. Score a -&gt; Bool
</span><a href="Music.Time.Score.html#hasOverlappingEvents"><span class="hs-identifier hs-var">hasOverlappingEvents</span></a></span><span> </span><span class="annot"><span class="annottext">Score a
</span><a href="#local-6989586621680580715"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (MVoice a)
forall a. Maybe a
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-191"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-192"></span><span>        </span><span class="annot"><span class="annottext">MVoice a -&gt; Maybe (MVoice a)
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(MVoice a -&gt; Maybe (MVoice a))
-&gt; (Score a -&gt; MVoice a) -&gt; Score a -&gt; Maybe (MVoice a)
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Note (Maybe a)]
-&gt; Getting (MVoice a) [Note (Maybe a)] (MVoice a) -&gt; MVoice a
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (MVoice a) [Note (Maybe a)] (MVoice a)
forall a. Iso' [Note a] (Voice a)
</span><a href="Music.Time.Voice.html#voice"><span class="hs-identifier hs-var">voice</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Note (Maybe a)] -&gt; MVoice a)
-&gt; (Score a -&gt; [Note (Maybe a)]) -&gt; Score a -&gt; MVoice a
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((Duration, Maybe a) -&gt; Note (Maybe a))
-&gt; [(Duration, Maybe a)] -&gt; [Note (Maybe a)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Duration, Maybe a)
-&gt; Getting (Note (Maybe a)) (Duration, Maybe a) (Note (Maybe a))
-&gt; Note (Maybe a)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Note (Maybe a)) (Duration, Maybe a) (Note (Maybe a))
forall a b. Iso (Duration, a) (Duration, b) (Note a) (Note b)
</span><a href="Music.Time.Note.html#note"><span class="hs-identifier hs-var">note</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Duration, Maybe a)] -&gt; [Note (Maybe a)])
-&gt; (Score a -&gt; [(Duration, Maybe a)])
-&gt; Score a
-&gt; [Note (Maybe a)]
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((Time, Duration, Maybe a) -&gt; (Duration, Maybe a))
-&gt; [(Time, Duration, Maybe a)] -&gt; [(Duration, Maybe a)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(Time, Duration, Maybe a) -&gt; (Duration, Maybe a)
forall a a b. (a, a, b) -&gt; (a, b)
</span><a href="#local-6989586621680580711"><span class="hs-identifier hs-var">throwTime</span></a></span><span> </span><span class="annot"><span class="annottext">([(Time, Duration, Maybe a)] -&gt; [(Duration, Maybe a)])
-&gt; (Score a -&gt; [(Time, Duration, Maybe a)])
-&gt; Score a
-&gt; [(Duration, Maybe a)]
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[(Time, Duration, a)] -&gt; [(Time, Duration, Maybe a)]
forall (t :: * -&gt; *) a a.
(Traversable t, AffineSpace a, Ord a, Num a) =&gt;
t (a, Diff a, a) -&gt; [(a, Diff a, Maybe a)]
</span><a href="#local-6989586621680580710"><span class="hs-identifier hs-var">addRests</span></a></span><span>
</span><span id="line-193"></span><span>          </span><span class="annot"><span class="annottext">([(Time, Duration, a)] -&gt; [(Time, Duration, Maybe a)])
-&gt; (Score a -&gt; [(Time, Duration, a)])
-&gt; Score a
-&gt; [(Time, Duration, Maybe a)]
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span>
</span><span id="line-194"></span><span>          </span><span class="hs-comment">-- TODO</span><span>
</span><span id="line-195"></span><span>          </span><span class="annot"><span class="annottext">((Time, Duration, a) -&gt; (Time, Duration, a) -&gt; Ordering)
-&gt; [(Time, Duration, a)] -&gt; [(Time, Duration, a)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">List.sortBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Time, Duration, a) -&gt; Time)
-&gt; (Time, Duration, a) -&gt; (Time, Duration, a) -&gt; Ordering
forall a b. Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Ordering
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">comparing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Time, Duration, a)
-&gt; Getting Time (Time, Duration, a) Time -&gt; Time
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting Time (Time, Duration, a) Time
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>          </span><span class="hs-comment">-- end TODO</span><span>
</span><span id="line-197"></span><span>          </span><span class="annot"><span class="annottext">([(Time, Duration, a)] -&gt; [(Time, Duration, a)])
-&gt; (Score a -&gt; [(Time, Duration, a)])
-&gt; Score a
-&gt; [(Time, Duration, a)]
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Score a
-&gt; Getting [(Time, Duration, a)] (Score a) [(Time, Duration, a)]
-&gt; [(Time, Duration, a)]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [(Time, Duration, a)] (Score a) [(Time, Duration, a)]
forall a b.
Lens
  (Score a) (Score b) [(Time, Duration, a)] [(Time, Duration, b)]
</span><a href="Music.Time.Score.html#triples"><span class="hs-identifier hs-var">triples</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>          </span><span class="annot"><span class="annottext">(Score a -&gt; Maybe (MVoice a)) -&gt; Score a -&gt; Maybe (MVoice a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Score a
</span><a href="#local-6989586621680580715"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-199"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-200"></span><span>        </span><span id="local-6989586621680580711"><span class="annot"><span class="annottext">throwTime :: (a, a, b) -&gt; (a, b)
</span><a href="#local-6989586621680580711"><span class="hs-identifier hs-var hs-var">throwTime</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680580706"><span class="annot"><span class="annottext">t :: a
</span><a href="#local-6989586621680580706"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680580705"><span class="annot"><span class="annottext">d :: a
</span><a href="#local-6989586621680580705"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680580704"><span class="annot"><span class="annottext">x :: b
</span><a href="#local-6989586621680580704"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680580705"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680580704"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>        </span><span id="local-6989586621680580710"><span class="annot"><span class="annottext">addRests :: t (a, Diff a, a) -&gt; [(a, Diff a, Maybe a)]
</span><a href="#local-6989586621680580710"><span class="hs-identifier hs-var hs-var">addRests</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t [(a, Diff a, Maybe a)] -&gt; [(a, Diff a, Maybe a)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">(t [(a, Diff a, Maybe a)] -&gt; [(a, Diff a, Maybe a)])
-&gt; (t (a, Diff a, a) -&gt; t [(a, Diff a, Maybe a)])
-&gt; t (a, Diff a, a)
-&gt; [(a, Diff a, Maybe a)]
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(a, t [(a, Diff a, Maybe a)]) -&gt; t [(a, Diff a, Maybe a)]
forall a b. (a, b) -&gt; b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">((a, t [(a, Diff a, Maybe a)]) -&gt; t [(a, Diff a, Maybe a)])
-&gt; (t (a, Diff a, a) -&gt; (a, t [(a, Diff a, Maybe a)]))
-&gt; t (a, Diff a, a)
-&gt; t [(a, Diff a, Maybe a)]
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, Diff a, a) -&gt; (a, [(a, Diff a, Maybe a)]))
-&gt; a -&gt; t (a, Diff a, a) -&gt; (a, t [(a, Diff a, Maybe a)])
forall (t :: * -&gt; *) a b c.
Traversable t =&gt;
(a -&gt; b -&gt; (a, c)) -&gt; a -&gt; t b -&gt; (a, t c)
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">List.mapAccumL</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (a, Diff a, a) -&gt; (a, [(a, Diff a, Maybe a)])
forall p a.
(AffineSpace p, Ord p) =&gt;
p -&gt; (p, Diff p, a) -&gt; (p, [(p, Diff p, Maybe a)])
</span><a href="#local-6989586621680580701"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-202"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-203"></span><span>            </span><span id="local-6989586621680580701"><span class="annot"><span class="annottext">g :: p -&gt; (p, Diff p, a) -&gt; (p, [(p, Diff p, Maybe a)])
</span><a href="#local-6989586621680580701"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span id="local-6989586621680580700"><span class="annot"><span class="annottext">u :: p
</span><a href="#local-6989586621680580700"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680580699"><span class="annot"><span class="annottext">t :: p
</span><a href="#local-6989586621680580699"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680580698"><span class="annot"><span class="annottext">d :: Diff p
</span><a href="#local-6989586621680580698"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680580697"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621680580697"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680580700"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">p -&gt; p -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680580699"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680580699"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">p -&gt; Diff p -&gt; p
forall p. AffineSpace p =&gt; p -&gt; Diff p -&gt; p
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="annot"><span class="annottext">Diff p
</span><a href="#local-6989586621680580698"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680580699"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Diff p
</span><a href="#local-6989586621680580698"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680580697"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680580700"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">p -&gt; p -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680580699"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680580699"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">p -&gt; Diff p -&gt; p
forall p. AffineSpace p =&gt; p -&gt; Diff p -&gt; p
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="annot"><span class="annottext">Diff p
</span><a href="#local-6989586621680580698"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680580700"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680580699"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">p -&gt; p -&gt; Diff p
forall p. AffineSpace p =&gt; p -&gt; p -&gt; Diff p
</span><span class="hs-operator hs-var">.-.</span></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680580700"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680580699"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Diff p
</span><a href="#local-6989586621680580698"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680580697"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; (p, [(p, Diff p, Maybe a)])
forall a. (?callStack::CallStack) =&gt; [Char] -&gt; a
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;scoreToVoice: Impossible!&quot;</span></span><span> </span><span class="hs-comment">-- Because of overlapping events guard</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span id="local-6989586621680580689"><span id="local-6989586621680580690"><span id="local-6989586621680580691"><span id="local-6989586621680580692"><span class="annot"><a href="Music.Score.Phrases.html#mapPhrasesWithPrevAndCurrentOnset"><span class="hs-identifier hs-type">mapPhrasesWithPrevAndCurrentOnset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#HasPhrases"><span class="hs-identifier hs-type">HasPhrases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580692"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580691"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580690"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580689"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Time.Types.html#Time"><span class="hs-identifier hs-type">Time</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#Phrase"><span class="hs-identifier hs-type">Phrase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580690"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Music.Time.Types.html#Time"><span class="hs-identifier hs-type">Time</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#Phrase"><span class="hs-identifier hs-type">Phrase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580690"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#Phrase"><span class="hs-identifier hs-type">Phrase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580689"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680580692"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680580691"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span>
</span><span id="line-209"></span><span id="mapPhrasesWithPrevAndCurrentOnset"><span class="annot"><span class="annottext">mapPhrasesWithPrevAndCurrentOnset :: (Maybe (Time, Phrase a) -&gt; Time -&gt; Phrase a -&gt; Phrase b) -&gt; s -&gt; t
</span><a href="Music.Score.Phrases.html#mapPhrasesWithPrevAndCurrentOnset"><span class="hs-identifier hs-var hs-var">mapPhrasesWithPrevAndCurrentOnset</span></a></span></span><span> </span><span id="local-6989586621680580688"><span class="annot"><span class="annottext">f :: Maybe (Time, Phrase a) -&gt; Time -&gt; Phrase a -&gt; Phrase b
</span><a href="#local-6989586621680580688"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASetter s t (Track (Phrase a)) (Track (Phrase b))
-&gt; (Track (Phrase a) -&gt; Track (Phrase b)) -&gt; s -&gt; t
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(MVoice a -&gt; Identity (MVoice b)) -&gt; s -&gt; Identity t
forall s t a b.
HasPhrases s t a b =&gt;
Traversal s t (MVoice a) (MVoice b)
</span><a href="Music.Score.Phrases.html#mvoices"><span class="hs-identifier hs-var">mvoices</span></a></span><span> </span><span class="annot"><span class="annottext">((MVoice a -&gt; Identity (MVoice b)) -&gt; s -&gt; Identity t)
-&gt; ((Track (Phrase a) -&gt; Identity (Track (Phrase b)))
    -&gt; MVoice a -&gt; Identity (MVoice b))
-&gt; ASetter s t (Track (Phrase a)) (Track (Phrase b))
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Track (Phrase a) -&gt; Identity (Track (Phrase b)))
-&gt; MVoice a -&gt; Identity (MVoice b)
forall a b. Lens (MVoice a) (MVoice b) (TVoice a) (TVoice b)
</span><a href="Music.Score.Phrases.html#mVoiceTVoice"><span class="hs-identifier hs-var">mVoiceTVoice</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe (Time, Phrase a) -&gt; Time -&gt; Phrase a -&gt; Phrase b)
-&gt; Track (Phrase a) -&gt; Track (Phrase b)
forall a b.
(Maybe (Time, a) -&gt; Time -&gt; a -&gt; b) -&gt; Track a -&gt; Track b
</span><a href="Music.Score.Phrases.html#withPrevAndCurrentOnset"><span class="hs-identifier hs-var">withPrevAndCurrentOnset</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Time, Phrase a) -&gt; Time -&gt; Phrase a -&gt; Phrase b
</span><a href="#local-6989586621680580688"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span id="local-6989586621680580891"><span id="local-6989586621680580892"><span class="annot"><a href="Music.Score.Phrases.html#withPrevAndCurrentOnset"><span class="hs-identifier hs-type">withPrevAndCurrentOnset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Time.Types.html#Time"><span class="hs-identifier hs-type">Time</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680580892"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Music.Time.Types.html#Time"><span class="hs-identifier hs-type">Time</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680580892"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680580891"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Music.Time.Track.html#Track"><span class="hs-identifier hs-type">Track</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580892"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Music.Time.Track.html#Track"><span class="hs-identifier hs-type">Track</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580891"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-212"></span><span id="withPrevAndCurrentOnset"><span class="annot"><span class="annottext">withPrevAndCurrentOnset :: (Maybe (Time, a) -&gt; Time -&gt; a -&gt; b) -&gt; Track a -&gt; Track b
</span><a href="Music.Score.Phrases.html#withPrevAndCurrentOnset"><span class="hs-identifier hs-var hs-var">withPrevAndCurrentOnset</span></a></span></span><span> </span><span id="local-6989586621680580684"><span class="annot"><span class="annottext">f :: Maybe (Time, a) -&gt; Time -&gt; a -&gt; b
</span><a href="#local-6989586621680580684"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASetter (Track a) (Track b) [Placed a] [Placed b]
-&gt; ([Placed a] -&gt; [Placed b]) -&gt; Track a -&gt; Track b
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="annot"><span class="annottext">ASetter (Track a) (Track b) [Placed a] [Placed b]
forall a b. Lens (Track a) (Track b) [Placed a] [Placed b]
</span><a href="Music.Time.Track.html#placeds"><span class="hs-identifier hs-var">placeds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Maybe (Placed a), Placed a, Maybe (Placed a)) -&gt; Placed b)
-&gt; [(Maybe (Placed a), Placed a, Maybe (Placed a))] -&gt; [Placed b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680580682"><span class="annot"><span class="annottext">x :: Maybe (Placed a)
</span><a href="#local-6989586621680580682"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680580681"><span class="annot"><span class="annottext">y :: Placed a
</span><a href="#local-6989586621680580681"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680580680"><span class="annot"><span class="annottext">z :: Maybe (Placed a)
</span><a href="#local-6989586621680580680"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Placed a -&gt; Placed b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Time, a) -&gt; Time -&gt; a -&gt; b
</span><a href="#local-6989586621680580684"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Placed a -&gt; (Time, a)) -&gt; Maybe (Placed a) -&gt; Maybe (Time, a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Placed a -&gt; (Time, a)
forall a. Placed a -&gt; (Time, a)
</span><a href="#local-6989586621680580679"><span class="hs-identifier hs-var">placedOnset</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Placed a)
</span><a href="#local-6989586621680580682"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Time, a) -&gt; Time
forall a b. (a, b) -&gt; a
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((Time, a) -&gt; Time) -&gt; (Time, a) -&gt; Time
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Placed a -&gt; (Time, a)
forall a. Placed a -&gt; (Time, a)
</span><a href="#local-6989586621680580679"><span class="hs-identifier hs-var">placedOnset</span></a></span><span> </span><span class="annot"><span class="annottext">Placed a
</span><a href="#local-6989586621680580681"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Placed a
</span><a href="#local-6989586621680580681"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Maybe (Placed a), Placed a, Maybe (Placed a))] -&gt; [Placed b])
-&gt; ([Placed a] -&gt; [(Maybe (Placed a), Placed a, Maybe (Placed a))])
-&gt; [Placed a]
-&gt; [Placed b]
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[Placed a] -&gt; [(Maybe (Placed a), Placed a, Maybe (Placed a))]
forall a. [a] -&gt; [(Maybe a, a, Maybe a)]
</span><a href="Music.Time.Internal.Util.html#withPrevNext"><span class="hs-identifier hs-var">withPrevNext</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621680580885"><span class="annot"><a href="#local-6989586621680580679"><span class="hs-identifier hs-type">placedOnset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Music.Time.Placed.html#Placed"><span class="hs-identifier hs-type">Placed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580885"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Time.Types.html#Time"><span class="hs-identifier hs-type">Time</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680580885"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-215"></span><span>    </span><span id="local-6989586621680580679"><span class="annot"><span class="annottext">placedOnset :: Placed a -&gt; (Time, a)
</span><a href="#local-6989586621680580679"><span class="hs-identifier hs-var hs-var">placedOnset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting (Time, a) (Placed a) (Time, a) -&gt; Placed a -&gt; (Time, a)
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnIso (Time, a) (Time, a) (Placed a) (Placed a)
-&gt; Iso (Placed a) (Placed a) (Time, a) (Time, a)
forall s t a b. AnIso s t a b -&gt; Iso b a t s
</span><span class="hs-identifier hs-var">from</span></span><span> </span><span class="annot"><span class="annottext">AnIso (Time, a) (Time, a) (Placed a) (Placed a)
forall a b. Iso (Time, a) (Time, b) (Placed a) (Placed b)
</span><a href="Music.Time.Placed.html#placed"><span class="hs-identifier hs-var">placed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span id="local-6989586621680580894"><span id="local-6989586621680580895"><span class="annot"><a href="Music.Score.Phrases.html#mVoiceTVoice"><span class="hs-identifier hs-type">mVoiceTVoice</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#MVoice"><span class="hs-identifier hs-type">MVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580895"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#MVoice"><span class="hs-identifier hs-type">MVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580894"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#TVoice"><span class="hs-identifier hs-type">TVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580895"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#TVoice"><span class="hs-identifier hs-type">TVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580894"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-218"></span><span id="mVoiceTVoice"><span class="annot"><span class="annottext">mVoiceTVoice :: (TVoice a -&gt; f (TVoice b)) -&gt; MVoice a -&gt; f (MVoice b)
</span><a href="Music.Score.Phrases.html#mVoiceTVoice"><span class="hs-identifier hs-var hs-var">mVoiceTVoice</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PVoice a -&gt; f (PVoice b)) -&gt; MVoice a -&gt; f (MVoice b)
forall a b. Lens (MVoice a) (MVoice b) (PVoice a) (PVoice b)
</span><a href="Music.Score.Phrases.html#mVoicePVoice"><span class="hs-identifier hs-var">mVoicePVoice</span></a></span><span> </span><span class="annot"><span class="annottext">((PVoice a -&gt; f (PVoice b)) -&gt; MVoice a -&gt; f (MVoice b))
-&gt; ((TVoice a -&gt; f (TVoice b)) -&gt; PVoice a -&gt; f (PVoice b))
-&gt; (TVoice a -&gt; f (TVoice b))
-&gt; MVoice a
-&gt; f (MVoice b)
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(TVoice a -&gt; f (TVoice b)) -&gt; PVoice a -&gt; f (PVoice b)
forall a b. Lens (PVoice a) (PVoice b) (TVoice a) (TVoice b)
</span><a href="Music.Score.Phrases.html#pVoiceTVoice"><span class="hs-identifier hs-var">pVoiceTVoice</span></a></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span id="local-6989586621680580874"><span id="local-6989586621680580875"><span class="annot"><a href="Music.Score.Phrases.html#pVoiceTVoice"><span class="hs-identifier hs-type">pVoiceTVoice</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#PVoice"><span class="hs-identifier hs-type">PVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580875"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#PVoice"><span class="hs-identifier hs-type">PVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580874"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#TVoice"><span class="hs-identifier hs-type">TVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580875"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Score.Phrases.html#TVoice"><span class="hs-identifier hs-type">TVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580874"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-221"></span><span id="pVoiceTVoice"><span class="annot"><span class="annottext">pVoiceTVoice :: (TVoice a -&gt; f (TVoice b)) -&gt; PVoice a -&gt; f (PVoice b)
</span><a href="Music.Score.Phrases.html#pVoiceTVoice"><span class="hs-identifier hs-var hs-var">pVoiceTVoice</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PVoice a -&gt; TVoice a)
-&gt; (PVoice a -&gt; TVoice b -&gt; PVoice b)
-&gt; Lens (PVoice a) (PVoice b) (TVoice a) (TVoice b)
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">PVoice a -&gt; TVoice a
forall a. PVoice a -&gt; TVoice a
</span><a href="#local-6989586621680580674"><span class="hs-identifier hs-var">pVoiceToTVoice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TVoice b -&gt; PVoice a -&gt; PVoice b)
-&gt; PVoice a -&gt; TVoice b -&gt; PVoice b
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">TVoice b -&gt; PVoice a -&gt; PVoice b
forall a b. TVoice a -&gt; PVoice b -&gt; PVoice a
</span><a href="#local-6989586621680580672"><span class="hs-identifier hs-var">tVoiceToPVoice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-223"></span><span>    </span><span id="local-6989586621680580866"><span class="annot"><a href="#local-6989586621680580674"><span class="hs-identifier hs-type">pVoiceToTVoice</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#PVoice"><span class="hs-identifier hs-type">PVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580866"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#TVoice"><span class="hs-identifier hs-type">TVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580866"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-224"></span><span>    </span><span id="local-6989586621680580674"><span class="annot"><span class="annottext">pVoiceToTVoice :: PVoice a -&gt; TVoice a
</span><a href="#local-6989586621680580674"><span class="hs-identifier hs-var hs-var">pVoiceToTVoice</span></a></span></span><span> </span><span id="local-6989586621680580671"><span class="annot"><span class="annottext">x :: PVoice a
</span><a href="#local-6989586621680580671"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Time, Phrase a)] -&gt; TVoice a
forall a. [(Time, a)] -&gt; Track a
</span><a href="Music.Score.Phrases.html#mkTrack"><span class="hs-identifier hs-var">mkTrack</span></a></span><span> </span><span class="annot"><span class="annottext">([(Time, Phrase a)] -&gt; TVoice a) -&gt; [(Time, Phrase a)] -&gt; TVoice a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Either Duration (Time, Phrase a)] -&gt; [(Time, Phrase a)]
forall a b. [Either a b] -&gt; [b]
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">rights</span></a></span><span> </span><span class="annot"><span class="annottext">([Either Duration (Time, Phrase a)] -&gt; [(Time, Phrase a)])
-&gt; [Either Duration (Time, Phrase a)] -&gt; [(Time, Phrase a)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((Time, Either Duration (Phrase a))
 -&gt; Either Duration (Time, Phrase a))
-&gt; [(Time, Either Duration (Phrase a))]
-&gt; [Either Duration (Time, Phrase a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Time, Either Duration (Phrase a))
-&gt; Either Duration (Time, Phrase a)
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable t, Applicative f) =&gt;
t (f a) -&gt; f (t a)
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">sequenceA</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Time, Either Duration (Phrase a))]
 -&gt; [Either Duration (Time, Phrase a)])
-&gt; [(Time, Either Duration (Phrase a))]
-&gt; [Either Duration (Time, Phrase a)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">([Duration] -&gt; [Time])
-&gt; [(Duration, Either Duration (Phrase a))]
-&gt; [(Time, Either Duration (Phrase a))]
forall a b c. ([a] -&gt; [b]) -&gt; [(a, c)] -&gt; [(b, c)]
</span><a href="Music.Score.Phrases.html#firsts"><span class="hs-identifier hs-var">firsts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Time -&gt; [Diff Time] -&gt; [Time]
forall p. AffineSpace p =&gt; p -&gt; [Diff p] -&gt; [p]
</span><a href="Data.AffineSpace.Point.Offsets.html#offsetPoints"><span class="hs-identifier hs-var">offsetPoints</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Music.Time.Types.html#Time"><span class="hs-identifier hs-type">Time</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PVoice a -&gt; [(Duration, Either Duration (Phrase a))]
forall (f :: * -&gt; *) a.
(Functor f, HasDuration a) =&gt;
f a -&gt; f (Duration, a)
</span><a href="Music.Score.Phrases.html#withDurationR"><span class="hs-identifier hs-var">withDurationR</span></a></span><span> </span><span class="annot"><span class="annottext">PVoice a
</span><a href="#local-6989586621680580671"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-comment">-- TODO assert no overlapping</span><span>
</span><span id="line-226"></span><span>    </span><span id="local-6989586621680580861"><span id="local-6989586621680580862"><span class="annot"><a href="#local-6989586621680580672"><span class="hs-identifier hs-type">tVoiceToPVoice</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#TVoice"><span class="hs-identifier hs-type">TVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580862"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#PVoice"><span class="hs-identifier hs-type">PVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580861"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Music.Score.Phrases.html#PVoice"><span class="hs-identifier hs-type">PVoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580862"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-227"></span><span>    </span><span id="local-6989586621680580672"><span class="annot"><span class="annottext">tVoiceToPVoice :: TVoice a -&gt; PVoice b -&gt; PVoice a
</span><a href="#local-6989586621680580672"><span class="hs-identifier hs-var hs-var">tVoiceToPVoice</span></a></span></span><span> </span><span id="local-6989586621680580665"><span class="annot"><span class="annottext">tv :: TVoice a
</span><a href="#local-6989586621680580665"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621680580664"><span class="annot"><span class="annottext">pv :: PVoice b
</span><a href="#local-6989586621680580664"><span class="hs-identifier hs-var">pv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASetter (PVoice b) (PVoice a) [Phrase b] [Phrase a]
-&gt; [Phrase a] -&gt; PVoice b -&gt; PVoice a
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">set</span></span><span> </span><span class="annot"><span class="annottext">ASetter (PVoice b) (PVoice a) [Phrase b] [Phrase a]
forall a b c. Lens [Either a b] [Either a c] [b] [c]
</span><a href="Music.Score.Phrases.html#_rights"><span class="hs-identifier hs-var">_rights</span></a></span><span> </span><span class="annot"><span class="annottext">[Phrase a]
</span><a href="#local-6989586621680580661"><span class="hs-identifier hs-var">newPhrases</span></a></span><span> </span><span class="annot"><span class="annottext">PVoice b
</span><a href="#local-6989586621680580664"><span class="hs-identifier hs-var">pv</span></a></span><span>
</span><span id="line-228"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-229"></span><span>        </span><span id="local-6989586621680580661"><span class="annot"><span class="annottext">newPhrases :: [Phrase a]
</span><a href="#local-6989586621680580661"><span class="hs-identifier hs-var hs-var">newPhrases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting (Endo [Phrase a]) (TVoice a) (Phrase a)
-&gt; TVoice a -&gt; [Phrase a]
forall a s. Getting (Endo [a]) s a -&gt; s -&gt; [a]
</span><span class="hs-identifier hs-var">toListOf</span></span><span> </span><span class="annot"><span class="annottext">Getting (Endo [Phrase a]) (TVoice a) (Phrase a)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">TVoice a
</span><a href="#local-6989586621680580665"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span id="local-6989586621680580838"><span id="local-6989586621680580839"><span id="local-6989586621680580840"><span class="annot"><a href="Music.Score.Phrases.html#_rights"><span class="hs-identifier hs-type">_rights</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580840"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580839"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580840"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580838"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680580839"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680580838"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-232"></span><span id="_rights"><span class="annot"><span class="annottext">_rights :: ([b] -&gt; f [c]) -&gt; [Either a b] -&gt; f [Either a c]
</span><a href="Music.Score.Phrases.html#_rights"><span class="hs-identifier hs-var hs-var">_rights</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Either a b] -&gt; [b])
-&gt; ([Either a b] -&gt; [c] -&gt; [Either a c])
-&gt; Lens [Either a b] [Either a c] [b] [c]
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">[Either a b] -&gt; [b]
forall a b. [Either a b] -&gt; [b]
</span><a href="#local-6989586621680580658"><span class="hs-identifier hs-var">_rightsGet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([c] -&gt; [Either a b] -&gt; [Either a c])
-&gt; [Either a b] -&gt; [c] -&gt; [Either a c]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [Either a b] -&gt; [Either a c]
forall c a b. [c] -&gt; [Either a b] -&gt; [Either a c]
</span><a href="#local-6989586621680580657"><span class="hs-identifier hs-var">_rightsSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-234"></span><span>    </span><span id="local-6989586621680580655"><span id="local-6989586621680580656"><span class="annot"><a href="#local-6989586621680580658"><span class="hs-identifier hs-type">_rightsGet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580656"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580655"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680580655"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-235"></span><span>    </span><span id="local-6989586621680580658"><span class="annot"><span class="annottext">_rightsGet :: [Either a b] -&gt; [b]
</span><a href="#local-6989586621680580658"><span class="hs-identifier hs-var hs-var">_rightsGet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either a b] -&gt; [b]
forall a b. [Either a b] -&gt; [b]
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">rights</span></a></span><span>
</span><span id="line-236"></span><span>    </span><span id="local-6989586621680580826"><span id="local-6989586621680580827"><span id="local-6989586621680580828"><span class="annot"><a href="#local-6989586621680580657"><span class="hs-identifier hs-type">_rightsSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680580828"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580827"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580826"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580827"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580828"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-237"></span><span>    </span><span id="local-6989586621680580657"><span class="annot"><span class="annottext">_rightsSet :: [c] -&gt; [Either a b] -&gt; [Either a c]
</span><a href="#local-6989586621680580657"><span class="hs-identifier hs-var hs-var">_rightsSet</span></a></span></span><span> </span><span id="local-6989586621680580654"><span class="annot"><span class="annottext">cs :: [c]
</span><a href="#local-6989586621680580654"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([c] -&gt; Either a b -&gt; ([c], Either a c))
-&gt; [c] -&gt; [Either a b] -&gt; [Either a c]
forall (t :: * -&gt; *) a b c.
Traversable t =&gt;
(a -&gt; b -&gt; (a, c)) -&gt; a -&gt; t b -&gt; t c
</span><a href="#local-6989586621680580653"><span class="hs-identifier hs-var">sndMapAccumL</span></a></span><span> </span><span class="annot"><span class="annottext">[c] -&gt; Either a b -&gt; ([c], Either a c)
forall b a b. [b] -&gt; Either a b -&gt; ([b], Either a b)
</span><a href="#local-6989586621680580652"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621680580654"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-238"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-239"></span><span>        </span><span id="local-6989586621680580652"><span class="annot"><span class="annottext">f :: [b] -&gt; Either a b -&gt; ([b], Either a b)
</span><a href="#local-6989586621680580652"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680580651"><span class="annot"><span class="annottext">cs :: [b]
</span><a href="#local-6989586621680580651"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621680580650"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621680580650"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621680580651"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either a b
forall a b. a -&gt; Either a b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680580650"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>        </span><span class="annot"><a href="#local-6989586621680580652"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680580649"><span class="annot"><span class="annottext">c :: b
</span><a href="#local-6989586621680580649"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621680580648"><span class="annot"><span class="annottext">cs :: [b]
</span><a href="#local-6989586621680580648"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621680580647"><span class="annot"><span class="annottext">b :: b
</span><a href="#local-6989586621680580647"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621680580648"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b -&gt; Either a b
forall a b. b -&gt; Either a b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680580649"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>        </span><span class="annot"><a href="#local-6989586621680580652"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ([b], Either a b)
forall a. (?callStack::CallStack) =&gt; [Char] -&gt; a
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;No more cs&quot;</span></span><span>
</span><span id="line-242"></span><span>    </span><span id="local-6989586621680580653"><span class="annot"><span class="annottext">sndMapAccumL :: (a -&gt; b -&gt; (a, c)) -&gt; a -&gt; t b -&gt; t c
</span><a href="#local-6989586621680580653"><span class="hs-identifier hs-var hs-var">sndMapAccumL</span></a></span></span><span> </span><span id="local-6989586621680580646"><span class="annot"><span class="annottext">f :: a -&gt; b -&gt; (a, c)
</span><a href="#local-6989586621680580646"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680580645"><span class="annot"><span class="annottext">z :: a
</span><a href="#local-6989586621680580645"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, t c) -&gt; t c
forall a b. (a, b) -&gt; b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">((a, t c) -&gt; t c) -&gt; (t b -&gt; (a, t c)) -&gt; t b -&gt; t c
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; (a, c)) -&gt; a -&gt; t b -&gt; (a, t c)
forall (t :: * -&gt; *) a b c.
Traversable t =&gt;
(a -&gt; b -&gt; (a, c)) -&gt; a -&gt; t b -&gt; (a, t c)
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">List.mapAccumL</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; (a, c)
</span><a href="#local-6989586621680580646"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680580645"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span id="local-6989586621680580851"><span id="local-6989586621680580852"><span id="local-6989586621680580853"><span class="annot"><a href="Music.Score.Phrases.html#firsts"><span class="hs-identifier hs-type">firsts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680580853"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680580852"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680580853"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680580851"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680580852"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680580851"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-245"></span><span id="firsts"><span class="annot"><span class="annottext">firsts :: ([a] -&gt; [b]) -&gt; [(a, c)] -&gt; [(b, c)]
</span><a href="Music.Score.Phrases.html#firsts"><span class="hs-identifier hs-var hs-var">firsts</span></a></span></span><span> </span><span id="local-6989586621680580644"><span class="annot"><span class="annottext">f :: [a] -&gt; [b]
</span><a href="#local-6989586621680580644"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([b] -&gt; [c] -&gt; [(b, c)]) -&gt; ([b], [c]) -&gt; [(b, c)]
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; [c] -&gt; [(b, c)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">(([b], [c]) -&gt; [(b, c)])
-&gt; ([(a, c)] -&gt; ([b], [c])) -&gt; [(a, c)] -&gt; [(b, c)]
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [b]) -&gt; ([a], [c]) -&gt; ([b], [c])
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [b]
</span><a href="#local-6989586621680580644"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(([a], [c]) -&gt; ([b], [c]))
-&gt; ([(a, c)] -&gt; ([a], [c])) -&gt; [(a, c)] -&gt; ([b], [c])
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, c)] -&gt; ([a], [c])
forall (f :: * -&gt; *) a b. Functor f =&gt; f (a, b) -&gt; (f a, f b)
</span><a href="Music.Score.Phrases.html#unzipR"><span class="hs-identifier hs-var">unzipR</span></a></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span id="local-6989586621680580859"><span class="annot"><a href="Music.Score.Phrases.html#mkTrack"><span class="hs-identifier hs-type">mkTrack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Music.Time.Types.html#Time"><span class="hs-identifier hs-type">Time</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680580859"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Music.Time.Track.html#Track"><span class="hs-identifier hs-type">Track</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580859"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-248"></span><span id="mkTrack"><span class="annot"><span class="annottext">mkTrack :: [(Time, a)] -&gt; Track a
</span><a href="Music.Score.Phrases.html#mkTrack"><span class="hs-identifier hs-var hs-var">mkTrack</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting (Track a) [Placed a] (Track a) -&gt; [Placed a] -&gt; Track a
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting (Track a) [Placed a] (Track a)
forall a. Getter [Placed a] (Track a)
</span><a href="Music.Time.Track.html#track"><span class="hs-identifier hs-var">track</span></a></span><span> </span><span class="annot"><span class="annottext">([Placed a] -&gt; Track a)
-&gt; ([(Time, a)] -&gt; [Placed a]) -&gt; [(Time, a)] -&gt; Track a
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((Time, a) -&gt; Placed a) -&gt; [(Time, a)] -&gt; [Placed a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting (Placed a) (Time, a) (Placed a) -&gt; (Time, a) -&gt; Placed a
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting (Placed a) (Time, a) (Placed a)
forall a b. Iso (Time, a) (Time, b) (Placed a) (Placed b)
</span><a href="Music.Time.Placed.html#placed"><span class="hs-identifier hs-var">placed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span id="local-6989586621680580848"><span id="local-6989586621680580849"><span class="annot"><a href="Music.Score.Phrases.html#withDurationR"><span class="hs-identifier hs-type">withDurationR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580849"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Music.Time.Duration.html#HasDuration"><span class="hs-identifier hs-type">HasDuration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580848"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680580849"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580848"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680580849"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Music.Time.Types.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680580848"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-251"></span><span id="withDurationR"><span class="annot"><span class="annottext">withDurationR :: f a -&gt; f (Duration, a)
</span><a href="Music.Score.Phrases.html#withDurationR"><span class="hs-identifier hs-var hs-var">withDurationR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (Duration, a)) -&gt; f a -&gt; f (Duration, a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; (Duration, a)) -&gt; f a -&gt; f (Duration, a))
-&gt; (a -&gt; (Duration, a)) -&gt; f a -&gt; f (Duration, a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680580640"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621680580640"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Duration
forall a. HasDuration a =&gt; a -&gt; Duration
</span><a href="Music.Time.Duration.html#_duration"><span class="hs-identifier hs-var">_duration</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680580640"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680580640"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- Group contigous sequences matching/not-matching the predicate.</span><span>
</span><span id="line-255"></span><span class="hs-comment">--</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- &gt;&gt;&gt; groupDiff (== 0) [0,1,2,3,5,0,0,6,7]</span><span>
</span><span id="line-257"></span><span class="hs-comment">-- [Right [0], Left [1,2,3,5], Right [0,0], Left [6,7]]</span><span>
</span><span id="line-258"></span><span id="local-6989586621680580999"><span class="annot"><a href="Music.Score.Phrases.html#groupDiff"><span class="hs-identifier hs-type">groupDiff</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680580999"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680580999"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680580999"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680580999"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-259"></span><span id="groupDiff"><span class="annot"><span class="annottext">groupDiff :: (a -&gt; Bool) -&gt; [a] -&gt; [Either [a] [a]]
</span><a href="Music.Score.Phrases.html#groupDiff"><span class="hs-identifier hs-var hs-var">groupDiff</span></a></span></span><span> </span><span id="local-6989586621680580638"><span class="annot"><span class="annottext">p :: a -&gt; Bool
</span><a href="#local-6989586621680580638"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-260"></span><span class="annot"><a href="Music.Score.Phrases.html#groupDiff"><span class="hs-identifier hs-var">groupDiff</span></a></span><span> </span><span id="local-6989586621680580637"><span class="annot"><span class="annottext">p :: a -&gt; Bool
</span><a href="#local-6989586621680580637"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680580636"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621680580636"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621680580635"><span class="annot"><span class="annottext">xs :: [a]
</span><a href="#local-6989586621680580635"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621680580637"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680580636"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Either [a] [a]
forall a b. a -&gt; Either a b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680580636"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; [a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">List.takeWhile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (a -&gt; Bool) -&gt; a -&gt; Bool
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621680580637"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680580635"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either [a] [a] -&gt; [Either [a] [a]] -&gt; [Either [a] [a]]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; [Either [a] [a]]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [Either [a] [a]]
</span><a href="Music.Score.Phrases.html#groupDiff"><span class="hs-identifier hs-var">groupDiff</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621680580637"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; [a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">List.dropWhile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (a -&gt; Bool) -&gt; a -&gt; Bool
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621680580637"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680580635"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621680580637"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680580636"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Either [a] [a]
forall a b. b -&gt; Either a b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680580636"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; [a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">List.takeWhile</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621680580637"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680580635"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either [a] [a] -&gt; [Either [a] [a]] -&gt; [Either [a] [a]]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; [Either [a] [a]]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [Either [a] [a]]
</span><a href="Music.Score.Phrases.html#groupDiff"><span class="hs-identifier hs-var">groupDiff</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621680580637"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; [a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">List.dropWhile</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621680580637"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680580635"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span id="local-6989586621680580798"><span id="local-6989586621680580799"><span id="local-6989586621680580800"><span class="annot"><a href="Music.Score.Phrases.html#unzipR"><span class="hs-identifier hs-type">unzipR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580800"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680580800"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680580799"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680580798"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680580800"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580799"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680580800"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680580798"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-265"></span><span id="unzipR"><span class="annot"><span class="annottext">unzipR :: f (a, b) -&gt; (f a, f b)
</span><a href="Music.Score.Phrases.html#unzipR"><span class="hs-identifier hs-var hs-var">unzipR</span></a></span></span><span> </span><span id="local-6989586621680580631"><span class="annot"><span class="annottext">x :: f (a, b)
</span><a href="#local-6989586621680580631"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((a, b) -&gt; a) -&gt; f (a, b) -&gt; f a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; a
forall a b. (a, b) -&gt; a
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">f (a, b)
</span><a href="#local-6989586621680580631"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">((a, b) -&gt; b) -&gt; f (a, b) -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; b
forall a b. (a, b) -&gt; b
</span><a href="../file:///nix/store/yi1zp26n2al045qmp9gwpxblhp2c8gs8-ghc-8.8.3-doc/share/doc/ghc/html/libraries/base-4.13.0.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">f (a, b)
</span><a href="#local-6989586621680580631"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span></pre></body></html>